// Code generated by goa v3.0.10, DO NOT EDIT.
//
// tmess gRPC client
//
// Command:
// $ goa gen terminal-chat/design

package client

import (
	"context"
	tmesspb "terminal-chat/gen/grpc/tmess/pb"
	tmess "terminal-chat/gen/tmess"
	tmessviews "terminal-chat/gen/tmess/views"

	goagrpc "goa.design/goa/v3/grpc"
	goapb "goa.design/goa/v3/grpc/pb"
	goa "goa.design/goa/v3/pkg"
	"google.golang.org/grpc"
)

// Client lists the service endpoint gRPC clients.
type Client struct {
	grpccli tmesspb.TmessClient
	opts    []grpc.CallOption
}

// EchoerClientStream implements the tmess.EchoerClientStream interface.
type EchoerClientStream struct {
	stream tmesspb.Tmess_EchoerClient
}

// ListenerClientStream implements the tmess.ListenerClientStream interface.
type ListenerClientStream struct {
	stream tmesspb.Tmess_ListenerClient
}

// SummaryClientStream implements the tmess.SummaryClientStream interface.
type SummaryClientStream struct {
	stream tmesspb.Tmess_SummaryClient
	view   string
}

// SubscribeClientStream implements the tmess.SubscribeClientStream interface.
type SubscribeClientStream struct {
	stream tmesspb.Tmess_SubscribeClient
}

// HistoryClientStream implements the tmess.HistoryClientStream interface.
type HistoryClientStream struct {
	stream tmesspb.Tmess_HistoryClient
	view   string
}

// NewClient instantiates gRPC client for all the tmess service servers.
func NewClient(cc *grpc.ClientConn, opts ...grpc.CallOption) *Client {
	return &Client{
		grpccli: tmesspb.NewTmessClient(cc),
		opts:    opts,
	}
}

// Login calls the "Login" function in tmesspb.TmessClient interface.
func (c *Client) Login() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildLoginFunc(c.grpccli, c.opts...),
			EncodeLoginRequest,
			DecodeLoginResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			resp := goagrpc.DecodeError(err)
			switch message := resp.(type) {
			case *goapb.ErrorResponse:
				return nil, goagrpc.NewServiceError(message)
			default:
				return nil, goa.Fault(err.Error())
			}
		}
		return res, nil
	}
}

// Echoer calls the "Echoer" function in tmesspb.TmessClient interface.
func (c *Client) Echoer() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildEchoerFunc(c.grpccli, c.opts...),
			EncodeEchoerRequest,
			DecodeEchoerResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			resp := goagrpc.DecodeError(err)
			switch message := resp.(type) {
			case *goapb.ErrorResponse:
				return nil, goagrpc.NewServiceError(message)
			default:
				return nil, goa.Fault(err.Error())
			}
		}
		return res, nil
	}
}

// Listener calls the "Listener" function in tmesspb.TmessClient interface.
func (c *Client) Listener() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildListenerFunc(c.grpccli, c.opts...),
			EncodeListenerRequest,
			DecodeListenerResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			resp := goagrpc.DecodeError(err)
			switch message := resp.(type) {
			case *goapb.ErrorResponse:
				return nil, goagrpc.NewServiceError(message)
			default:
				return nil, goa.Fault(err.Error())
			}
		}
		return res, nil
	}
}

// Summary calls the "Summary" function in tmesspb.TmessClient interface.
func (c *Client) Summary() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildSummaryFunc(c.grpccli, c.opts...),
			EncodeSummaryRequest,
			DecodeSummaryResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			resp := goagrpc.DecodeError(err)
			switch message := resp.(type) {
			case *goapb.ErrorResponse:
				return nil, goagrpc.NewServiceError(message)
			default:
				return nil, goa.Fault(err.Error())
			}
		}
		return res, nil
	}
}

// Subscribe calls the "Subscribe" function in tmesspb.TmessClient interface.
func (c *Client) Subscribe() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildSubscribeFunc(c.grpccli, c.opts...),
			EncodeSubscribeRequest,
			DecodeSubscribeResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			resp := goagrpc.DecodeError(err)
			switch message := resp.(type) {
			case *goapb.ErrorResponse:
				return nil, goagrpc.NewServiceError(message)
			default:
				return nil, goa.Fault(err.Error())
			}
		}
		return res, nil
	}
}

// History calls the "History" function in tmesspb.TmessClient interface.
func (c *Client) History() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildHistoryFunc(c.grpccli, c.opts...),
			EncodeHistoryRequest,
			DecodeHistoryResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			resp := goagrpc.DecodeError(err)
			switch message := resp.(type) {
			case *goapb.ErrorResponse:
				return nil, goagrpc.NewServiceError(message)
			default:
				return nil, goa.Fault(err.Error())
			}
		}
		return res, nil
	}
}

// Recv reads instances of "tmesspb.EchoerResponse" from the "echoer" endpoint
// gRPC stream.
func (s *EchoerClientStream) Recv() (string, error) {
	var res string
	v, err := s.stream.Recv()
	if err != nil {
		return res, err
	}
	return NewEchoerResponse(v), nil
}

// Send streams instances of "tmesspb.EchoerStreamingRequest" to the "echoer"
// endpoint gRPC stream.
func (s *EchoerClientStream) Send(res string) error {
	v := NewEchoerStreamingRequest(res)
	return s.stream.Send(v)
}

func (s *EchoerClientStream) Close() error {
	// Close the send direction of the stream
	return s.stream.CloseSend()
}

// Send streams instances of "tmesspb.ListenerStreamingRequest" to the
// "listener" endpoint gRPC stream.
func (s *ListenerClientStream) Send(res string) error {
	v := NewListenerStreamingRequest(res)
	return s.stream.Send(v)
}

func (s *ListenerClientStream) Close() error {
	// synchronize and report any server error
	_, err := s.stream.CloseAndRecv()
	return err
}

// CloseAndRecv reads instances of "tmesspb.ChatSummaryCollection" from the
// "summary" endpoint gRPC stream.
func (s *SummaryClientStream) CloseAndRecv() (tmess.ChatSummaryCollection, error) {
	var res tmess.ChatSummaryCollection
	v, err := s.stream.CloseAndRecv()
	if err != nil {
		return res, err
	}
	proj := NewChatSummaryCollection(v)
	vres := tmessviews.ChatSummaryCollection{Projected: proj, View: "default"}
	return tmess.NewChatSummaryCollection(vres), nil
}

// Send streams instances of "tmesspb.SummaryStreamingRequest" to the "summary"
// endpoint gRPC stream.
func (s *SummaryClientStream) Send(res string) error {
	v := NewSummaryStreamingRequest(res)
	return s.stream.Send(v)
}

// Recv reads instances of "tmesspb.SubscribeResponse" from the "subscribe"
// endpoint gRPC stream.
func (s *SubscribeClientStream) Recv() (*tmess.Event, error) {
	var res *tmess.Event
	v, err := s.stream.Recv()
	if err != nil {
		return res, err
	}
	if err = ValidateSubscribeResponse(v); err != nil {
		return res, err
	}
	return NewEvent(v), nil
}

// Recv reads instances of "tmesspb.HistoryResponse" from the "history"
// endpoint gRPC stream.
func (s *HistoryClientStream) Recv() (*tmess.ChatSummary, error) {
	var res *tmess.ChatSummary
	v, err := s.stream.Recv()
	if err != nil {
		return res, err
	}
	proj := NewChatSummaryView(v)
	vres := &tmessviews.ChatSummary{Projected: proj, View: s.view}
	return tmess.NewChatSummary(vres), nil
}

// SetView sets the view.
func (s *HistoryClientStream) SetView(view string) {
	s.view = view
}
